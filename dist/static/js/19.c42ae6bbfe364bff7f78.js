webpackJsonp([19],{WZOv:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={props:{title:{default:"",type:String},icon:{default:"",type:String}},data:function(){return{regin_disabled:!1,errors:[],notificationsForm:{id:null,text:"",country_id:0,region_id:0},edit:!1,dialog:!1,deleteDialog:!1,forceDelete:!1,selectedItem:null,requests:[],Countries:[],Region:[],totalRequests:0,pagination:{},search:"",loading:!1,disapprove:!1,approve:!1,headers:[{text:"الاشعار",align:"right",value:"text",sortable:!1},{text:"البلد",align:"right",value:"title_ar",sortable:!1},{text:"المدينة",align:"right",value:"title_ar",sortable:!1},{text:"عمليات",align:"cneter",value:"actions",sortable:!1}],editedItem:null,alert:{message:"",type:"success"},page:1,index:null}},computed:{formTitle:function(){return"اضافة اشعار"},pages:function(){return null==this.pagination.rowsPerPage||null==this.pagination.totalItems?0:Math.ceil(this.pagination.totalItems/this.pagination.rowsPerPage)}},mounted:function(){this.fetch(),this.fetchCountries()},methods:{fetch:function(){var t=this;this.$http.get("admin/get_notifications").then(function(e){t.requests=e.data.data,t.totalRequests=t.requests.length})},fetchCountries:function(){var t=this;this.$http.get("admin/country").then(function(e){t.Countries=e.data.data})},fetchRegionByCountryId:function(t){var e=this;this.$http.get("admin/fetch_region/"+t).then(function(t){e.Region=t.data.data})},close:function(){var t=this;this.dialog=!1,setTimeout(function(){t.editedItem=-1},300),this.notificationsForm={id:null,text:"",country_id:0,region_id:0}},save:function(){var t=this;this.$http.post("admin/ads_notifications",this.notificationsForm).then(function(e){t.requests.push(e.data.data),t.alert.message="تم ارسال اشعار جديد بنجاح !",t.alert.type="success",t.close()})},deletenNotification:function(t){var e=this;this.deleting=!0;var i=this.requests.indexOf(t);confirm("هل تريد مسح الاشعار")?this.$http.delete("admin/delete_notifications/"+t.id).then(function(t){e.requests.splice(i,1),e.alert.message="تم مسح الاشعار!",e.alert.type="success",e.deleting=!1}):this.deleting=!1}}},n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"elevation-2"},[i("vuetify-alert",{attrs:{message:t.alert.message},on:{message:function(e){t.alert.message=""}}}),t._v(" "),i("v-toolbar",{attrs:{flat:"",color:"white"}},[i("v-toolbar-title",{},[i("v-icon",{attrs:{medium:""}},[t._v(t._s(t.icon))]),t._v("\n      "+t._s(t.title)+"\n    ")],1),t._v(" "),i("v-spacer"),t._v(" "),i("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[i("v-tooltip",{attrs:{slot:"activator",top:""},slot:"activator"},[i("v-btn",{staticClass:"mb-2",attrs:{slot:"activator",color:"primary",fab:"",dark:"",small:""},on:{click:function(e){t.edit=!1,t.errors=[]}},slot:"activator"},[i("v-icon",[t._v("add")])],1),t._v(" "),i("span",[t._v("إضافة اشعار جديد")])],1),t._v(" "),i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[t._v(t._s(t.formTitle))])]),t._v(" "),i("v-card-text",[i("v-list",[t._l(t.errors,function(e){return[i("v-list-tile",{key:e[0]+Math.random()},[i("v-list-tile-content",[i("v-list-tile-title",{staticClass:"text-xs-center"},t._l(e,function(e){return i("span",{key:e+Math.random(),staticClass:"red--text"},[t._v("\n                      "+t._s(e)+"\n                      "),i("v-icon",{attrs:{color:"red"}},[t._v("error")])],1)}))],1)],1)]})],2)],1),t._v(" "),i("v-card-text",[i("v-container",{attrs:{"grid-list-md":""}},[i("v-layout",{attrs:{wrap:""}},[i("v-flex",[i("v-text-field",{attrs:{label:"الاشعار"},model:{value:t.notificationsForm.text,callback:function(e){t.$set(t.notificationsForm,"text",e)},expression:"notificationsForm.text"}}),t._v(" "),i("v-select",{staticStyle:{height:"42px","font-size":"11px"},attrs:{flat:"",dense:"",items:[{title_ar:"الدول",id:null}].concat(t.Countries),"item-text":"title_ar","item-value":"id",label:"الدول"},on:{change:function(e){t.fetchRegionByCountryId(""+t.notificationsForm.country_id)}},model:{value:t.notificationsForm.country_id,callback:function(e){t.$set(t.notificationsForm,"country_id",e)},expression:"notificationsForm.country_id"}}),t._v(" "),i("v-select",{staticStyle:{height:"42px","font-size":"11px"},attrs:{flat:"",dense:"",items:[{title_ar:"المناطق",id:null}].concat(t.Region),"item-text":"title_ar","item-value":"id",label:"المناطق",disabled:t.regin_disabled},model:{value:t.notificationsForm.region_id,callback:function(e){t.$set(t.notificationsForm,"region_id",e)},expression:"notificationsForm.region_id"}}),t._v(" "),i("v-checkbox",{staticClass:"mx-2",attrs:{label:"ارسال الى كل المناطق التابعة للدولة"},model:{value:t.regin_disabled,callback:function(e){t.regin_disabled=e},expression:"regin_disabled"}})],1)],1)],1)],1),t._v(" "),i("v-card-actions",[i("v-spacer"),t._v(" "),i("v-btn",{staticClass:"ma-2",attrs:{color:"",small:""},nativeOn:{click:function(e){return t.close(e)}}},[t._v("الغاء")]),t._v(" "),i("v-btn",{staticClass:"ma-2",attrs:{color:"primary",dark:"",small:""},nativeOn:{click:function(e){return t.save(e)}}},[t._v("حفظ")])],1)],1)],1)],1),t._v(" "),i("v-data-table",{attrs:{headers:t.headers,items:t.requests,"total-items":t.totalRequests,loading:t.loading,search:t.search,"hide-actions":"",pagination:t.pagination},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"items",fn:function(e){return[i("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.text))]),t._v(" "),i("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.title_ar))]),t._v(" "),e.item.region_title?i("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.region_title))]):i("td",{staticClass:"text-xs-right"},[t._v("جميع المناطق")]),t._v(" "),i("td",{staticClass:"justify-right layout px-0"},[i("v-tooltip",{attrs:{top:""}},[i("v-btn",{attrs:{slot:"activator",icon:"",loading:t.disapprove,flat:"",color:"red"},on:{click:function(i){t.deletenNotification(e.item)}},slot:"activator"},[i("v-icon",{staticClass:"mr-2 red--text"},[t._v("delete")])],1),t._v(" "),i("span",[t._v("مسح الاشعار")])],1)],1)]}}])}),t._v(" "),i("div",{staticClass:"text-xs-center pt-2"},[i("v-pagination",{attrs:{"total-visible":"100",color:"primary",length:t.pages},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1)],1)},staticRenderFns:[]},s={components:{NotificationsTable:i("VU/8")(a,n,!1,null,null,null).exports}},o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("v-container",[e("notifications-table",{attrs:{title:"الاشعارات",icon:"language"}})],1)},staticRenderFns:[]};var l=i("VU/8")(s,o,!1,function(t){i("xGNg")},null,null);e.default=l.exports},xGNg:function(t,e){}});